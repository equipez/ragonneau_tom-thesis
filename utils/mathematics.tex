%% utils/mathematics.tex
%% Copyright 2021-2022 Tom M. Ragonneau
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2005/12/01 or later.
%
% This work has the LPPL maintenance status `maintained'.
%
% The Current Maintainer of this work is Tom M. Ragonneau.
\RequirePackage{amsmath}
\RequirePackage{amsthm}
\RequirePackage{amsfonts}
\RequirePackage{amssymb}
\RequirePackage{mathtools}
\RequirePackage{bm}
\RequirePackage[scr=boondoxo,bb=dsfontserif]{mathalfa}
\RequirePackage{textgreek}
\RequirePackage{empheq}
\RequirePackage[breakable,skins,theorems]{tcolorbox}
\RequirePackage{xargs}

% General aspect of the mathematical expressions and environments
\numberwithin{equation}{section}

% Maximum number of columns in a matrix
\setcounter{MaxMatrixCols}{20}

% Mathematical constants, sets, and notations
\newcommand{\eu}{\mathrm{e}}
\newcommand{\iu}{\mathrm{i}}
\newcommand{\du}{\mathrm{d}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\T}{\mathsf{T}}

% Extra mathematical sets
\newcommand{\lpoly}{\mathscr{L}(\R^n)}
\newcommand{\qpoly}{\mathscr{Q}(\R^n)}

% Mathematical operators
\DeclareMathOperator{\act}{\mathcal{A}}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator{\bigo}{\mathcal{O}}
\DeclareMathOperator{\card}{card}
\DeclareMathOperator{\cond}{\kappa}
\DeclareMathOperator{\conv}{conv}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\smallo}{o}
\DeclareMathOperator{\vspan}{span}
\newcommand{\eqdef}{\mathrel{\stackrel{\mathsf{def}}{=}}}

% Mathematical macros
\newcommand{\abs}[2][]{#1\lvert#2#1\rvert}
\newcommand{\ceil}[2][]{#1\lceil#2#1\rceil}
\newcommand{\floor}[2][]{#1\lfloor#2#1\rfloor}
\newcommand{\negp}[2][]{#1[#2#1]_-}
\newcommand{\norm}[2][]{#1\lVert#2#1\rVert}
\newcommand{\posp}[2][]{#1[#2#1]_+}
\newcommand{\set}[2][]{#1\{#2#1\}}
\newcommand{\inner}[2][]{#1\langle#2#1\rangle}

% Mathematical environments (theorems, proofs, ...)
\theoremstyle{definition}
\newtheorem{assumption}{Assumption}[section]
\newtheorem{condition}{Condition}[section]
\newtheorem{definition}{Definition}[section]
\newtheorem{example}{Example}[section]
\newtheorem{problem}{Problem}[section]
\theoremstyle{plain}
\newtheorem{conjecture}{Conjecture}[section]
\newtheorem{proposition}{Proposition}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[theorem]
\theoremstyle{remark}
\newtheorem*{annotation}{Annotation}
\newtheorem*{claim}{Claim}
\newtheorem*{note}{Note}
\newtheorem*{remark}{Remark}

% Display mathematical environments in boxes
\tcbset{%
    after skip=\baselineskip,%
    before skip=\baselineskip,%
    boxrule=0pt,%
    breakable,%
    colback=gray!15,%
    enhanced jigsaw,%
    frame hidden,%
    shield externalize,%
}
\tcolorboxenvironment{assumption}{borderline west={4pt}{0pt}{black!30}}
\tcolorboxenvironment{condition}{borderline west={4pt}{0pt}{black!30}}
\tcolorboxenvironment{definition}{borderline west={4pt}{0pt}{OliveGreen!50}}
\tcolorboxenvironment{example}{borderline west={4pt}{0pt}{black!30}}
\tcolorboxenvironment{problem}{borderline west={4pt}{0pt}{black!30}}
\tcolorboxenvironment{conjecture}{borderline west={4pt}{0pt}{black!30}}
\tcolorboxenvironment{proposition}{borderline west={4pt}{0pt}{BlueViolet!40}}
\tcolorboxenvironment{theorem}{borderline west={4pt}{0pt}{BlueViolet!40}}
\tcolorboxenvironment{corollary}{borderline west={4pt}{0pt}{BlueViolet!40}}
\tcolorboxenvironment{lemma}{borderline west={4pt}{0pt}{BlueViolet!40}}
\tcolorboxenvironment{annotation}{borderline west={4pt}{0pt}{black!30}}
\tcolorboxenvironment{claim}{borderline west={4pt}{0pt}{black!30}}
\tcolorboxenvironment{note}{borderline west={4pt}{0pt}{black!30}}
\tcolorboxenvironment{remark}{borderline west={4pt}{0pt}{black!30}}

% Fine-tuning spacing in formulas
% Make @ behave as per catcode 13 (active). The TeXbook, p. 155.
\mathcode`@="8000{\catcode`\@=\active\gdef@{\mkern1mu}}

% Dedicated mathematical macros
\newcommand{\auglag}{\mathcal{L}_{\mathsf{A}}}
\newcommand{\auglagalt}{\widetilde{\mathcal{L}}_{\mathsf{A}}}
\newcommandx{\ball}[2][1={},2={}]{\mathcal{B}\ifthenelse{\equal{#1}{}}{}{_{#1}}\ifthenelse{\equal{#2}{}}{}{^{#2}}}
\newcommand{\con}[1]{c_{#1}}
% \newcommand{\conm}[2][]{\hat{c}_{\ifthenelse{\equal{#1}{}}{}{{#1}, }#2}}
\newcommand{\conm}[2][]{\hat{c}_{#2}\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\fset}{\Omega}
\newcommand{\iter}[1][]{x\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\lag}[1][]{\mathcal{L}\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\lagalt}[1][]{\widetilde{\mathcal{L}}\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\lagm}[1][]{\widehat{\mathcal{L}}\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\lagp}[1][]{L\ifthenelse{\equal{#1}{}}{}{_{#1}}}
\newcommand{\lm}[1][]{\lambda\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\merit}[1][]{\varphi\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\meritm}[1][]{\widehat{\varphi}\ifthenelse{\equal{#1}{}}{}{^{@@#1}}}
\newcommand{\nstep}[1][]{n\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\nstepalt}[1][]{\bar{n}\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\obj}{f}
\newcommand{\objm}[1][]{\hat{f}\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\pstep}[1][]{p\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\rad}[1][]{\Delta\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\radlb}[1][]{\delta\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\ratio}[1][]{\rho\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\rstep}[1][]{r\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\sstep}[1][]{s\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\step}[1][]{d\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\tstep}[1][]{t\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\xpb}[1][]{\mathcal{P}}
\newcommand{\xpt}[1][]{\mathcal{Y}\ifthenelse{\equal{#1}{}}{}{^{#1}}}
\newcommand{\xsv}[1][]{\mathcal{S}}

\newcommand{\xl}{l}
\newcommand{\xu}{u}
\newcommand{\ieq}{\mathcal{E}}
\newcommand{\iub}{\mathcal{I}}
